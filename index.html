<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Práctica Imperfecto Francés - 30 Preguntas</title>
<style>
  body {font-family: Arial, sans-serif; margin:20px; background:#f9f9f9;}
  .question {margin-bottom:15px; padding:10px; background:white; border-radius:8px;}
  .hidden {display:none;}
  button {margin:5px;}
  #score {font-weight:bold;}
</style>
</head>
<body>

<h1>Práctica Imperfecto Francés</h1>
<div id="quiz"></div>

<div>
  <button id="prevBtn">Anterior</button>
  <button id="nextBtn">Siguiente</button>
  <button id="checkBtn">Ver resultados actuales</button>
  <button id="refreshBtn">Reiniciar práctica</button>
</div>

<p id="score"></p>

<script>
// ==================== CONFIGURACIÓN ====================
const questions = [
  // --- Preguntas 1-30 ---
  {q:"Yo (être) ... à l'école", a:"étais"},
  {q:"Tú (avoir) ... un chien", a:"avais"},
  {q:"Él (aller) ... au marché", a:"allait"},
  {q:"Nosotros (finir) ... nos devoirs", a:"finissions"},
  {q:"Vosotros (parler) ... souvent", a:"parliez"},
  {q:"Ellos (prendre) ... le bus", a:"prenaient"},
  {q:"Yo (faire) ... du sport", a:"faisais"},
  {q:"Tú (venir) ... chez moi", a:"venais"},
  {q:"Él (manger) ... des fruits", a:"mangeait"},
  {q:"Nosotros (lire) ... un livre", a:"lisions"},
  // 11-20
  {q:"Vosotros (écrire) ... des lettres", a:"écriviez"},
  {q:"Ellos (dire) ... la vérité", a:"disaient"},
  {q:"Yo (pouvoir) ... chanter", a:"pouvais"},
  {q:"Tú (vouloir) ... aider", a:"voulais"},
  {q:"Él (savoir) ... tout", a:"savait"},
  {q:"Nosotros (connaître) ... la ville", a:"connaissions"},
  {q:"Vosotros (travailler) ... tard", a:"travailliez"},
  {q:"Ellos (jouer) ... au foot", a:"jouaient"},
  {q:"Yo (boire) ... du lait", a:"buvais"},
  {q:"Tú (courir) ... vite", a:"courais"},
  // 21-30
  {q:"Él (choisir) ... un cadeau", a:"choisissait"},
  {q:"Nosotros (ouvrir) ... la porte", a:"ouvrions"},
  {q:"Vosotros (mettre) ... la table", a:"mettiez"},
  {q:"Ellos (recevoir) ... des lettres", a:"recevaient"},
  {q:"Yo (croire) ... en toi", a:"croyais"},
  {q:"Tú (vivre) ... à Paris", a:"vivais"},
  {q:"Él (attendre) ... le bus", a:"attendait"},
  {q:"Nosotros (chanter) ... ensemble", a:"chantions"},
  {q:"Vosotros (danser) ... au bal", a:"dansiez"},
  {q:"Ellos (parvenir) ... à temps", a:"parvenaient"}
];

const questionsPerPage = 10;
let currentPage = parseInt(localStorage.getItem('currentPage') || '0');
let answers = JSON.parse(localStorage.getItem('answers') || '[]');

// Inicializar array answers si vacío
if (answers.length !== questions.length) {
  answers = Array(questions.length).fill('');
}

// ==================== FUNCIONES ====================
function renderPage() {
  const quizDiv = document.getElementById('quiz');
  quizDiv.innerHTML = '';
  const startIndex = currentPage * questionsPerPage;
  const endIndex = Math.min(startIndex + questionsPerPage, questions.length);

  for (let i=startIndex; i<endIndex; i++) {
    const qDiv = document.createElement('div');
    qDiv.className='question';
    qDiv.innerHTML = `
      <p><strong>Pregunta ${i+1}:</strong> ${questions[i].q}</p>
      <input type="text" data-index="${i}" value="${answers[i]}">
    `;
    quizDiv.appendChild(qDiv);
  }
  saveProgress();
}

function saveProgress(){
  localStorage.setItem('answers', JSON.stringify(answers));
  localStorage.setItem('currentPage', currentPage);
}

function checkScore(){
  let correct=0;
  let details='';
  for (let i=0; i<questions.length; i++){
    const user=answers[i].trim().toLowerCase();
    const good=questions[i].a.toLowerCase();
    if(user===good){correct++;}
    else {
      details+=`<p>Pregunta ${i+1}: Tu respuesta: <em>${user}</em>. Correcta: <strong>${good}</strong></p>`;
    }
  }
  const nota=(correct/questions.length*10).toFixed(2);
  document.getElementById('score').innerHTML=
    `Aciertos: ${correct}/${questions.length} — Nota: ${nota}/10<br>${details}`;
}

// ==================== EVENTOS ====================
document.getElementById('quiz').addEventListener('input', (e)=>{
  if(e.target.tagName==='INPUT'){
    const idx=parseInt(e.target.dataset.index);
    answers[idx]=e.target.value;
    saveProgress();
  }
});

document.getElementById('nextBtn').addEventListener('click', ()=>{
  if((currentPage+1)*questionsPerPage<questions.length){
    currentPage++;
    renderPage();
  }
});

document.getElementById('prevBtn').addEventListener('click', ()=>{
  if(currentPage>0){
    currentPage--;
    renderPage();
  }
});

document.getElementById('checkBtn').addEventListener('click', checkScore);

document.getElementById('refreshBtn').addEventListener('click', ()=>{
  if(confirm("¿Seguro que deseas reiniciar la práctica?")){
    localStorage.removeItem('answers');
    localStorage.removeItem('currentPage');
    answers=Array(questions.length).fill('');
    currentPage=0;
    renderPage();
    document.getElementById('score').innerHTML='';
  }
});

// ==================== INICIO ====================
renderPage();

</script>
</body>
</html>
